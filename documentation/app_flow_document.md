# App Flow Document

## Onboarding and Sign-In/Sign-Up
A new user arrives at the FloraFauna Encyclopedia through a public landing page that introduces the project and invites them to explore. From this page, the user can click a clearly labeled "Sign Up" button that opens a modal powered by Clerk. The modal offers sign-up via email and password or through social logins such as Google or GitHub. As the user enters their information, real-time validation checks for a valid email format and strong password. Once the account is created, a confirmation email is sent with a link to verify the address. If the user forgets their password, they can click the "Forgot Password?" link on the sign-in form; Clerk will send a reset link. After signing in, the user is redirected to the Home Page. At any point, the user can sign out via the profile menu in the header, which logs them out and returns them to the landing page.

## Main Dashboard or Home Page
After successfully logging in, the user lands on the Home Page, which features a clean header with the FloraFauna logo on the left, a global search bar in the center, and the user’s avatar on the right. Below the header, a horizontal navigation menu lists sections labeled "Species," "Learn," "Map," and "Articles." The center of the page displays a curated carousel of featured species and recent articles. To the right, a vertical sidebar contains quick links to the AI Recognition Tool, user contributions, and settings. From this Home Page, the user can click any navigation link or search query to move deeper into the application.

## Detailed Feature Flows and Page Transitions

### Species Encyclopedia Browsing and Detail Page
When the user clicks "Species" in the navigation or enters a species name in the search bar, they are taken to a catalog page rendered as a Next.js Server Component. This page shows a grid of species cards, each with a thumbnail image and common name. Clicking a card transitions the user to a dynamic route at `/species/[slug]`, where the Server Component fetches detailed information from Supabase. The Species Detail Page presents taxonomy, morphology, habitat, conservation status, and an interactive image gallery. Sections expand or collapse for deeper research data, and a "Contribute an Update" button is available to users with contributor permissions.

### Contributor System Workflow
A logged-in user who clicks "Contribute" from any content page is taken to a protected form at `/contribute/new`. Clerk’s authentication guard ensures only signed-in users can access it. The form allows input of text fields, dropdowns for taxonomy, file uploads for images, and optional reference links. Upon submission, the data is saved to a draft table in Supabase under the user’s ID. If the user has a moderator role, they are redirected to an approval dashboard listing pending submissions at `/admin/moderate`. Moderators can approve, request revisions, or reject entries. Once approved, the new content goes live and appears in the public encyclopedia.

### Smart Search and Filter
At the top of the Species Catalog or via the global search bar, users can type in keywords. As they type, the client-side component calls an API route that queries Supabase through TanStack React Query, returning live results with auto-complete suggestions. Users can refine their search using filters such as habitat, conservation status, or distribution. Selecting or deselecting filters updates the results instantly without a full page reload. Clicking on any result navigates the user to the corresponding species detail page.

### AI Recognition Tool Flow
From the sidebar or the Home Page tile, the user clicks "AI Recognition Tool" and lands on a client component at `/tools/recognition`. They are prompted to upload an image from their device. As soon as the file is selected, it uploads to Supabase Storage and triggers a HuggingFace model call via a serverless API endpoint. The user sees a loading spinner, and once the model returns potential matches with confidence scores, the interface displays a ranked list of species names linked to their detail pages. If the image is too large or unsupported, an inline error message prompts the user to try a different file.

### Interactive Map of Biodiversity
When the user clicks "Map" in the main navigation, they encounter a LeafletJS-based client component at `/map`. The map fetches geospatial records from Supabase and plots distribution markers. Users can pan, zoom, and apply overlay layers for climate zones or protected areas via toggle buttons on the map’s legend. Clicking a marker opens a tooltip with the species’ common name and a small image; clicking the tooltip navigates to the full species page. The legend remains visible at all times to help users refine which data layers appear.

### Educational Module: Quizzes and Flashcards
Accessed by clicking "Learn" in the header, users arrive at a page presenting two tabs: "Quizzes" and "Flashcards." In "Quizzes," users choose a topic and difficulty level from dropdowns and begin a series of multiple-choice or image-identification questions generated from the database. Immediate feedback appears after each answer, and a progress bar shows completion status. At the end, users receive a score and earn badges displayed on their profile. In "Flashcards," users flip cards showing species images on one side and details on the other, with buttons to mark cards as mastered or to review later.

### Article and Blog Section
Clicking "Articles" takes the user to a responsive grid layout at `/articles`. Each tile shows the article title, author, date, and a preview image. Clicking a tile routes to `/articles/[slug]`, where a Server Component renders the article with rich text, embedded images, and related posts suggestions. Logged-in authors see an "Edit" button that opens a rich-text editor in a modal for updating content. Readers can share posts via social links and leave comments if enabled.

## Settings and Account Management
The user clicks their avatar in the header to open a dropdown and selects "Profile Settings." The profile page displays personal information fields—name, email—and preferences for notifications and theme (light or dark). Users can toggle email notifications for contributions, quizzes, or new articles. If there is a subscription or premium tier, a "Billing" tab shows payment methods, invoices, and a button to upgrade or cancel. Saving changes updates Clerk and Supabase records. A "Back to Home" link returns the user to the main dashboard.

## Error States and Alternate Paths
If the user submits invalid data—such as an unsupported image format in the AI tool or missing required form fields—the app displays inline error messages under the relevant input with clear instructions for correction. If the user loses connectivity while filling a form, an offline banner appears, and data is temporarily cached until connectivity returns. Attempting to access a protected route without authentication redirects the user to the sign-in page with a message explaining the need to sign in. A non-existent species slug or article slug results in a custom 404 page that offers a link back to the catalog or home page.

## Conclusion and Overall App Journey
From the moment a user signs up or signs in, they are welcomed by a clear Home Page that directs them toward exploration, contribution, learning, and research. Browsing the Species Encyclopedia leads to rich content pages, while the Smart Search and interactive map help them find exactly what they need. Contributors use a secure workflow to add or edit entries, and moderators maintain quality through a dedicated dashboard. The AI Recognition Tool and educational quizzes deepen engagement, and the article platform supports sharing of in-depth knowledge. Throughout every step, the user has clear paths back to the main flow, robust error handling, and settings to manage their personal experience, culminating in an intuitive, end-to-end encyclopedia application.